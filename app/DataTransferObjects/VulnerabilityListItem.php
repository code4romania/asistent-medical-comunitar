<?php

declare(strict_types=1);

namespace App\DataTransferObjects;

use Illuminate\Contracts\Support\Arrayable;

readonly class VulnerabilityListItem implements Arrayable
{
    public function __construct(
        public string $label,
        public string | int | null $value,
        public string | null $type = null,
        public string | null $category = null,
        public array $otherLogItems = [],
        public bool $valid = false,
    ) {
        //
    }

    protected function getLogItems(): array
    {
        return collect([
            $this->value,
            $this->category,
        ])
            ->concat($this->otherLogItems)
            ->filter()
            ->unique()
            ->sort()
            ->values()
            ->all();
    }

    public function toArray()
    {
        return $this->getLogItems();
    }
}
